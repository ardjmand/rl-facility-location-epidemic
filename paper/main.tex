\documentclass[3p, sort&compress]{elsarticle}
\usepackage[T1]{fontenc}  % Required for Polish characters (ogonek) in bibliography
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx,psfrag,epsf}
\usepackage{enumerate}
\usepackage{url} % not crucial - just used below for the URL 
\usepackage[numbers]{natbib} % added by Alireza
\usepackage{etoolbox}
\usepackage{lineno}
\usepackage{hyperref}
% \usepackage{graphicx} 
\usepackage{lipsum}
\usepackage{subcaption}
\usepackage{amsthm,amssymb}
\usepackage{bm}% bold math
\usepackage{hyperref}% add hypertext capabilities
\usepackage{dsfont}
% \usepackage[caption=false]{subfig}
\usepackage{tabularx}
\usepackage{float}
\usepackage{makecell}
\usepackage{algorithm}
\usepackage{algcompatible}
\usepackage{algpseudocode}
\usepackage[section]{placeins}%This prevents placing floats before a section.
\usepackage{multirow}
\usepackage{todonotes}
\usepackage{caption}
\usepackage{array,makecell}
\usepackage{subcaption}
\usepackage{comment}
\usepackage{amssymb}
\usepackage{framed}
\usepackage{multicol}
\usepackage{makecell}
\usepackage{nomencl}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage[toc, acronym]{glossaries}
\usepackage[nolist, printonlyused]{acronym}
\journal{Elsevier}

\makenomenclature


\newtheorem{remark}{Remark}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
% \bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
% \bibliographystyle{model2-names.bst}\biboptions{square,sort,comma,numbers}

%% Vancouver numbered
% \usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
% \bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style (doesn't support \citet author names)
% \bibliographystyle{elsarticle-num}
% \bibliographystyle{plainnat}
\bibliographystyle{abbrvnat}  % Supports \citet with numbered citations


%%%%%%%%%%%%%%%%%%%%%%%



\begin{document}
\input{nomenclature}
	
\begin{frontmatter}
	
	\title{Dynamic Facility Location via Reinforcement Learning for Epidemic Suppression in Contact Networks}
	
	\author[a]{Ehsan Ardjmand\corref{cor1}}
	\ead{ardjmand@ohio.edu}
	
	\cortext[cor1]{Corresponding authors}
	
	\address[a]{Department of Analytics and Information Systems, College of Business, Ohio University, OH, USA, 45701}
	
\begin{abstract}
TBD \dots
\end{abstract}
	
\begin{keyword}
    TBD \dots
\end{keyword}
	
\end{frontmatter}

\section{Introduction} \label{sec:intro}

The rapid global spread of infectious diseases, exemplified by the COVID-19 pandemic, has underscored the critical importance of effective vaccination strategies in mitigating epidemic outbreaks \cite{Khairi2022race}. While vaccine development has advanced remarkably, the successful deployment of vaccination programs depends not only on vaccine efficacy but also on the accessibility of vaccination services to the population \cite{sharma2020understanding}. Empirical evidence consistently demonstrates that vaccination uptake decreases with increasing distance to vaccination facilities, creating spatial disparities in immunization coverage that can undermine public health objectives \cite{orgut2023equitable, scroggins2023spatial}. This distance-decay phenomenon motivates the strategic placement of vaccination facilities as a fundamental lever for epidemic control.

Traditional epidemiological models, originating from the seminal work of \citet{kermack1927contribution}, assume homogeneous mixing within populations. However, infectious diseases spread through networks of human contacts that exhibit substantial heterogeneity in connectivity patterns \cite{danon2011networks, pastor2015epidemic}. The structure of these contact networks profoundly influences epidemic dynamics, including transmission rates, final outbreak sizes, and the effectiveness of intervention strategies \cite{kiss2017mathematics}. Network-based models reveal phenomena absent from homogeneous models, such as the persistence of infections in highly connected populations even at low transmission rates \cite{PastorSatorras2001}. Furthermore, realistic epidemic models must account for imperfect and waning immunity: vaccinated individuals may experience breakthrough infections, and both vaccine-induced and infection-acquired immunity diminish over time \cite{kaminska2022immunity, brown2021outbreak}. These considerations necessitate epidemic models that capture the interplay between network structure, spatial vaccination accessibility, and realistic immunological dynamics.

The facility location problem, a classical topic in operations research, addresses the optimal placement of service facilities to minimize costs while meeting demand \cite{Belanger2019}. In the context of vaccination, facility location determines the spatial accessibility of immunization services. The dynamic variant of this problem extends the classical formulation to settings where facilities can be opened, closed, or relocated over time in response to changing conditions \cite{Jena2016, Silva2021}. During an epidemic, the optimal configuration of vaccination facilities evolves as the disease spreads through the population: regions experiencing outbreaks may require additional capacity, while facilities in areas with high vaccination coverage may become redundant. Opening and closing facilities incur transition costs, creating a sequential decision problem where current actions affect future options. This temporal coupling, combined with the stochastic nature of epidemic dynamics and the large state space induced by network-level modeling, renders traditional optimization approaches computationally intractable for real-time decision support.

\Ac{RL} offers a principled framework for sequential decision-making under uncertainty, learning policies that maximize cumulative rewards through interaction with an environment \cite{levine2020offline}. Recent applications of \ac{RL} to epidemic control have demonstrated its potential for optimizing public health interventions, including movement restrictions, resource allocation, and vaccination strategies \cite{ohi2020exploring, kwak2021deep, bushaj2023simulation}. \Ac{PPO} has emerged as a particularly robust algorithm for epidemic intervention planning, achieving superior performance with less hyperparameter sensitivity than alternative methods \cite{mai2023planning, schulman2017proximal}. The integration of \ac{RL} with \ac{GNN} enables policies that directly process graph-structured data, capturing both local neighborhood information and global network properties \cite{cappart2023combinatorial, dai2017learning}. For epidemic control on contact networks, \ac{GNN}-based policies can learn representations that encode the structural relationships among individuals and facilities, enabling spatially-aware decision-making \cite{ling2024cooperating}.

Despite substantial progress in both \ac{RL} for epidemic control and dynamic facility location, a significant gap remains at their intersection. Existing \ac{RL} approaches for epidemic management have primarily focused on population-level interventions such as lockdowns or aggregate vaccine allocation, without explicitly modeling the spatial dynamics of vaccination facility access \cite{hao2022reinforcement, awasthi2022vacsim, rey2023vaccine}. Conversely, facility location research has largely addressed static or slowly-varying demand patterns, without coupling to the rapid dynamics of epidemic spread on contact networks \cite{Miao2024}. The problem of dynamically controlling vaccination facilities in response to evolving network-based epidemic dynamics---where facility decisions directly affect vaccination rates through distance-dependent accessibility, and these rates in turn influence disease transmission---has not been previously addressed.

This study bridges this gap by formulating and solving a novel dynamic facility location problem for epidemic control on contact networks. The main contributions of this work are as follows:
\begin{itemize}
    \item \textbf{Novel problem formulation}: We introduce a dynamic vaccination facility location problem that integrates network-based \ac{SIV} epidemic dynamics with distance-dependent vaccination rates. The model captures waning immunity, breakthrough infections, and the spatial coupling between facility decisions and individual vaccination behavior.

    \item \textbf{Heterogeneous graph representation}: We represent the joint system of individuals and facilities as a heterogeneous graph with multiple node types (individuals and facilities) and edge types (contact network, individual-facility proximity, and facility-facility distances), enabling rich structural information to inform decision-making.

    \item \textbf{\ac{GNN}-based \ac{RL} approach}: We develop a deep \ac{RL} algorithm using \ac{PPO} with a heterogeneous \ac{GNN} encoder that processes the graph-structured state representation. The actor network outputs per-facility open/close decisions while the critic estimates state values through graph-level pooling.

    \item \textbf{Mean-field analytical framework}: We derive a mean-field approximation of the stochastic epidemic model that provides theoretical insights into equilibrium conditions, informs the design of training scenarios, and enables systematic evaluation of learned policies.

    \item \textbf{Computational experiments}: We demonstrate through extensive experiments that the learned \ac{RL} policy outperforms static baseline strategies across diverse epidemic scenarios, adapting facility configurations to evolving disease dynamics while balancing infection costs, vaccination costs, and operational expenses.
\end{itemize}

The remainder of this paper is organized as follows. Section~\ref{sec:LitRev} provides a comprehensive review of related literature spanning epidemic modeling, \ac{RL} for public health, dynamic facility location, and \ac{GNN} for combinatorial optimization. Section~\ref{sec:ProbStat} formally defines the problem, including the contact network representation, \ac{SIV} compartmental dynamics, spatial vaccination model, and cost structure. Section~\ref{sec:AnalyticalModelDev} develops the analytical mean-field approximation and characterizes equilibrium conditions. Section~\ref{sec:RLMethod} presents the proposed \ac{RL} methodology, including the heterogeneous \ac{GNN} architecture and training procedure. Section~\ref{sec:Experiments} reports computational experiments comparing the learned policy against baseline strategies. Finally, Section~\ref{sec:Conclusions} summarizes the findings and discusses directions for future research.

\section{Literature Review} \label{sec:LitRev}

The problem addressed in this study lies at the intersection of several research streams: epidemic modeling on contact networks, \ac{RL} for public health intervention, dynamic facility location, and vaccine allocation optimization. This section provides a comprehensive review of these interconnected domains and identifies the research gap that the present work aims to fill.

\subsection{Epidemic Modeling on Contact Networks}

The mathematical modeling of infectious disease spread has evolved significantly from the seminal work of \citet{kermack1927contribution}, who introduced compartmental models assuming homogeneous mixing within populations. However, the recognition that human contact patterns are inherently heterogeneous has driven the development of network-based epidemic models \cite{Keeling2005, danon2011networks}.

\citet{PastorSatorras2001} demonstrated a fundamental result: in scale-free networks where degree distributions follow a power law, the epidemic threshold effectively vanishes, allowing infections to persist even at arbitrarily low transmission rates. This finding underscored the critical importance of network topology in determining epidemic outcomes. \citet{Newman2002} extended these results by developing exact solutions for \ac{SIR} epidemics on networks with arbitrary degree distributions using generating function methods.

The comprehensive review by \citet{pastor2015epidemic} established that network structure profoundly influences epidemic dynamics, including the basic reproduction number, final epidemic size, and effectiveness of intervention strategies. \citet{kiss2017mathematics} provided a unified mathematical framework connecting graph theory, stochastic processes, and dynamical systems for epidemic modeling, introducing tools such as pairwise approximation and edge-based compartmental models.

More recent work has incorporated realistic features such as waning immunity and breakthrough infections. The COVID-19 pandemic highlighted that vaccine-induced and infection-acquired immunity can diminish over time \cite{kaminska2022immunity}, and vaccinated individuals may still become infected \cite{brown2021outbreak, covid2021covid}. These observations motivate the \ac{SIV} model employed in the present study, which captures both waning immunity ($V \to S$) and breakthrough infections ($V \to I$).

\subsection{Reinforcement Learning for Epidemic Control}

The application of \ac{RL} to epidemic control has gained substantial momentum, particularly following the COVID-19 pandemic. \citet{ohi2020exploring} applied \ac{DQN} to optimize movement restrictions in \ac{SEIR} models, demonstrating that \ac{RL} agents could learn to balance epidemic control against economic costs. \citet{kwak2021deep} trained dueling double \ac{DQN} agents on epidemiological data from 216 countries, finding that \ac{RL}-based policies recommended earlier and more intensive interventions than those implemented by governments.

The simulation-\ac{DRL} framework proposed by \citet{bushaj2023simulation} combined agent-based epidemic simulation with \ac{DRL}, showing that \ac{RL}-guided vaccination strategies could reduce infections by up to 32\% compared to heuristic approaches. \citet{mai2023planning} demonstrated that \ac{PPO} is particularly robust for epidemic intervention planning, requiring less hyperparameter tuning than alternative algorithms while achieving superior performance.

Several studies have specifically addressed vaccine allocation using \ac{RL}. \citet{rey2023vaccine} developed \ac{RL}-based vaccine allocation policies with budget-sharing mechanisms, while \citet{hao2022reinforcement} employed hierarchical \ac{RL} for large-scale COVID-19 vaccine allocation, achieving 9--12\% reductions in infections and deaths compared to baseline strategies. \citet{awasthi2022vacsim} introduced VacSIM, an \ac{RL} framework for learning vaccine distribution strategies that accounts for demographic heterogeneity.

The integration of \ac{RL} with \ac{GNN} for epidemic control represents a recent advancement. \citet{ling2024cooperating} proposed cooperating \acp{GNN} with \ac{DRL} for vaccine prioritization, capturing structural properties of mobility contact networks. \citet{ardjmand2024guided} developed a guided \ac{TD3} approach for vaccine allocation in contact networks, demonstrating superiority over centrality-based heuristics.

\subsection{Dynamic Facility Location Problems}

The facility location problem, a classical topic in operations research, has been extensively studied in both static and dynamic settings \cite{Belanger2019}. The dynamic facility location problem extends the classical formulation to multi-period settings where facilities can be opened, closed, or relocated over time in response to changing demand patterns.

\citet{Jena2016} addressed dynamic facility location with partial closing and reopening through modular capacity frameworks, developing Lagrangian relaxation-based heuristics for large-scale instances. \citet{Silva2021} proposed heuristics for the dynamic facility location problem with modular capacities, combining linear relaxation methods with hybrid genetic algorithms. These studies established that accounting for opening and closing costs significantly affects optimal facility configurations over time.

Recent work has addressed uncertainty and disruptions in facility location. \citet{Cheng2021} developed robust facility location models that simultaneously consider demand uncertainty and facility disruptions using two-stage robust optimization. \citet{Gourtani2020} formulated two-stage distributionally robust facility location problems that hedge against incomplete distributional information.

The application of machine learning to facility location is emerging. \citet{Miao2024} recently applied \ac{DRL} to the multi-period $p$-median dynamic location problem, explicitly considering temporal impacts of location decisions across planning horizons. This represents one of the first applications of \ac{DRL} to dynamic facility location, though it did not consider epidemic dynamics or vaccination contexts.

\subsection{Vaccine Allocation and Spatial Accessibility}

Optimal vaccine allocation has been studied extensively from both epidemiological and operations research perspectives \cite{duijzer2018literature, blasioli2023vaccine}. Mathematical modeling approaches have addressed age-based prioritization \cite{bubar2021model, matrajt2021vaccine}, occupation-based strategies \cite{nunner2022prioritizing, buckner2021dynamic}, and network-based allocation \cite{chen2022effective, saunders2021covid}.

Spatial accessibility to vaccination services significantly affects uptake rates \cite{sharma2020understanding}. \citet{venkatramanan2019optimizing} optimized spatial allocation of seasonal influenza vaccines under temporal constraints, demonstrating that geographic targeting can outperform age-based prioritization. \citet{scroggins2023spatial} applied spatial optimization to COVID-19 vaccine distribution, finding that optimized allocation could decrease case incidence by 8\% while preventing over 100 deaths.

The deployment of mobile and temporary vaccination sites has received attention for improving accessibility and equity. \citet{li2022deploying} formulated mobile vaccination site deployment as a dynamic $k$-supplier problem, developing approximation algorithms that balance accessibility with equity considerations. Distance-decay models for vaccination behavior, where uptake decreases with distance to vaccination sites, have been validated empirically and incorporated into optimization models \cite{orgut2023equitable}. However, these models typically assume static facility configurations rather than dynamic opening and closing decisions responsive to evolving epidemic conditions.

\subsection{Graph Neural Networks for Combinatorial Optimization}

\acp{GNN} have emerged as powerful tools for combinatorial optimization problems \cite{cappart2023combinatorial}. The foundational work of \citet{dai2017learning} combined \ac{RL} with graph embeddings for NP-hard problems including vertex cover and \ac{TSP}, demonstrating that learned policies can generalize to problem instances larger than those seen during training.

\citet{kool2019attention} introduced attention-based models for routing problems, achieving near-optimal results on \ac{TSP} instances and extending to \ac{VRP} variants. \citet{gasse2019exact} applied graph convolutional networks to branch-and-bound variable selection in \ac{MILP}, representing \acp{MILP} as bipartite graphs and outperforming expert-designed branching rules.

Heterogeneous \acp{GNN}, which handle graphs with multiple node and edge types, are particularly relevant for problems involving different entity types. \citet{wang2019heterogeneous} introduced hierarchical attention mechanisms for heterogeneous graphs, enabling automatic discovery of important relationship types. Applications of \acp{GNN} to epidemic modeling have begun to emerge, with \citet{panagopoulos2021transfer} developing transfer \acp{GNN} for COVID-19 forecasting using meta-learning approaches.

\subsection{Research Gap and Contributions}

Despite the substantial body of work reviewed above, a significant gap remains at the intersection of these research streams. Existing studies on \ac{RL} for epidemic control have primarily focused on population-level interventions such as lockdowns or aggregate vaccine allocation, without explicitly modeling the spatial dynamics of vaccination facility access. Conversely, facility location research has largely addressed static or slowly-varying demand patterns, without coupling to the rapid dynamics of epidemic spread on contact networks.

The present study addresses this gap by formulating a novel problem that integrates:
\begin{itemize}
    \item \textbf{Network-based epidemic dynamics}: Disease spread is modeled on explicit contact networks using an \ac{SIV} compartmental model that captures waning immunity and breakthrough infections.
    \item \textbf{Spatial vaccination accessibility}: Vaccination rates depend on individuals' distances to open facilities, creating a direct coupling between facility decisions and epidemic dynamics.
    \item \textbf{Dynamic facility decisions}: Facilities can be opened or closed over time, with associated transition costs, allowing adaptation to evolving epidemic conditions.
    \item \textbf{Reinforcement learning optimization}: A deep \ac{RL} approach with \ac{GNN} policy representations learns optimal facility control policies that minimize total costs including infection burden, vaccination costs, and facility operations.
\end{itemize}

To the best of the authors' knowledge, this is the first study to address dynamic vaccination facility location as a sequential decision problem on contact networks using \ac{RL}. The integration of heterogeneous \acp{GNN} enables the policy to capture both the contact network structure and the spatial relationships between individuals and facilities, while the mean-field analytical framework provides theoretical insights that guide algorithm development and enable systematic performance evaluation.

\section{Problem Statement} \label{sec:ProbStat}

The population's contact structure can be represented by an undirected graph $\mathcal{G}(\mathcal{V}, \mathcal{E})$, where $\mathcal{V} = \{1, 2, \dots, n\}$ denotes the set of individuals (nodes), and $\mathcal{E}$ represents the set of pairwise interactions or contacts (edges) among them. For a given individual $i \in \mathcal{V}$, the neighborhood $\mathcal{N}_i$ consists of all nodes directly connected to $i$, with cardinality $|\mathcal{N}_i| = N_i$.

At any discrete or continuous time $t$, the state of node $i$ is denoted by $X_i^t$, which can assume one of the following three values: susceptible ($S$), infected ($I$), or vaccinated ($V$). In this study, the vaccinated state $V$ is defined broadly to include both individuals who have received vaccination and those who have recovered from infection, under the assumption that both groups possess comparable immunity against the disease.

A node $i$ in the susceptible state ($S$) may become infected ($I$) at a rate proportional to the number of infected neighbors. Specifically, the transition from $S$ to $I$ occurs at a rate of $\beta_1 N_i^I$, where $\beta_1$ is the per-contact infection rate, and $N_i^I = |\mathcal{N}_i^I|$ represents the number of infected neighbors of node $i$ (i.e., the size of the infected subset of $i$’s neighborhood).

Following infection, an individual transitions from the infected state ($I$) to the vaccinated state ($V$) at a recovery rate $\delta$. This transition captures the acquisition of post-infection immunity. However, this immunity is not assumed to be permanent. A node in the vaccinated state ($V$) may experience a breakthrough infection and transition back to the infected state ($I$) at a reduced infection rate of $\beta_2 N_i^I$, where $\beta_2 < \beta_1$ reflects partial immunity. Additionally, immunity may wane over time, and a vaccinated individual may return to the susceptible state ($S$) at a rate $\omega$, capturing the natural decay of immunity.

Apart from acquiring immunity through recovery, a susceptible individual can become vaccinated. The vaccination rate for an individual $i$ is denoted by $\nu_i$ and is modeled as a decreasing function of the individual’s spatial distance to the nearest active vaccination facility. Let $\mathcal{M} = {m_1, m_2, \dots, m_M}$ denote the set of candidate vaccination facility locations, where each $m_j \in \mathbb{R}^2$ is specified by its spatial coordinates. Each individual $i \in \mathcal{V}$ is also assumed to occupy a fixed position $z_i \in \mathbb{R}^2$. If a subset $L \subseteq \mathcal{M}$ of these facilities is selected to be operational, then the vaccination rate for individual $i$ becomes:

\[
\nu_i(L) = v_{min} +  (v_{max} - v_{min})e^{-\alpha d_i(L)}, \qquad d_i(L) = \min_{m \in L} \| z_i - c \|.
\]
\noindent where, $v_{max}$ and $v_{min}$ denote the minimum and maximum achievable vaccination rates, corresponding to zero and infinite distance from a facility, $\alpha > 0$ is a decay parameter controlling how quickly the vaccination rate decreases with increasing distance, and $d_i(L)$ represents the shortest Euclidean distance between individual $i$ and the nearest facility in the active set $L$.

Figure~\ref{fig:MarkovModel} illustrates the corresponding state-transition diagram for this model, along with an example contact network composed of four individuals. Each node resides in one of the three possible states: susceptible ($S$), infected ($I$), or vaccinated ($V$). In this example, two individuals are susceptible, one is infected, and one is vaccinated, highlighting the heterogeneity in state distribution across the network.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{figures/markov_model.pdf}
        %\caption{Caption for Image 1}
        %\label{fig:subfig1}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{figures/graph_markov.pdf}
        %\caption{Caption for Image 2}
        %\label{fig:subfig2}
    \end{subfigure}
    \caption{Left: The state transition diagram of the \ac{SIV} model representing the disease progression for an individual. Right: A schematic representation of a contact network in which each node follows the dynamics of the \ac{SIV} model. The shadowed compartments indicate the current states (susceptible, infected, or vaccinated) of the individuals within the network.}
    \label{fig:MarkovModel}
\end{figure}

This study employs \ac{RL} to dynamically determine the optimal subset of vaccination facilities $L \subseteq \mathcal{M}$ to be open at any given time. To facilitate this process, the time horizon is discretized into $t = 1, 2, \dots, T$ decision steps. At the beginning of each time step, the \ac{RL} agent evaluates the status of each candidate facility $m_j \in \mathcal{M}$ and decides whether it should be opened or closed.

Opening a facility incurs a one-time setup cost denoted by $f^+$, while closing an existing facility incurs a decommissioning cost $f^-$. In addition to these transition costs, each facility that remains operational during a time step incurs a fixed operational cost $C_O$, which accounts for expenses such as personnel, rent, and utilities. The model also includes health-related costs: each vaccinated individual incurs a vaccination cost $C_V$, and each infected individual generates a disease burden cost $C_I$.

The objective of the \ac{RL} agent is to minimize the cumulative cost over the planning horizon. This total cost includes the expenses associated with opening and closing facilities, operational costs, vaccination costs, and the social or economic cost of infections across the population. It is assumed that each open facility has unlimited service capacity within a time step, allowing it to vaccinate any number of individuals. Furthermore, the time required to open or close a facility is considered negligible, and the underlying structure of the contact network is assumed to remain unchanged during these administrative actions.

After the \ac{RL} agent makes its decisions regarding facility operations at the beginning of a time step, the epidemic progresses according to the \ac{SIV} dynamics depicted in Figure~\ref{fig:MarkovModel}. The disease spreads through the contact network while individuals transition among the susceptible, infected, and vaccinated compartments. This interaction between the agent’s strategic decisions and the evolving epidemic continues iteratively at each time step until the final time $T$ is reached, forming a decision-making process between vaccination logistics and disease progression. 

\section{Analytical Model Development} \label{sec:AnalyticalModelDev}
This section presents an analytical framework based on a mean-field approximation to investigate the dynamics of disease spread in the presence of spatially distributed vaccination facilities. The development of this model serves three primary purposes:

\begin{itemize}
    \item \textbf{Characterization of Equilibrium Conditions}: The model facilitates the identification of threshold conditions under which the disease either dies out, leading to a \ac{DFE}, or becomes endemic, depending on the configuration of the open vaccination facilities $L$. These insights provide a foundational understanding of how spatial access to vaccination affects long-term epidemiological outcomes.
    \item \textbf{\ac{RL} Guidance}: The analytical results derived from the model are used to inform and guide the training of the proposed \ac{RL} algorithm, thereby improving the efficiency and robustness of the \ac{RL} training process.
    \item \textbf{Test Case Design}: The model enables the systematic generation of test scenarios to evaluate the \ac{RL} algorithm’s performance. By varying parameters that govern the underlying dynamics, controlled experimental settings can be designed to benchmark and stress-test the \ac{RL} policy under different dynamic regimes.
\end{itemize}

In the \ac{SIV} framework illustrated in Figure~\ref{fig:MarkovModel}, let \(s_i, p_i,\) and \(q_i \in [0,1]\) denote, respectively, the probabilities that node \(i \in \mathcal V\) is susceptible (\(S\)), infected (\(I\)), or vaccinated (\(V\)).  Associate with every node a categorical random variable \(X_i \in \{S,I,V\}\) whose realization at time \(t\) is written \(X_i^{t}\).  The vector \(\boldsymbol X^{t}=(X_1^{t},\dots,X_n^{t})\), therefore, captures the instantaneous configuration of the entire contact network. Over an infinitesimal interval \(\Delta t>0\), the state of each node evolves according to a continuous-time Markov chain. Conditional one-step transition probabilities for node \(i\) are

\begin{equation}\label{eq:StochasticModel}
        \begin{aligned}
            & \text{Pr}\left(X_i^{t+\Delta t}=I|X_i^t=S, \boldsymbol{X}^t\right) = \beta_1 \Delta t \sum_{j \in \mathcal{N}_i} 1_{\{X_j^t=I\}} + o\left(\Delta t\right) \\
            & \text{Pr}\left(X_i^{t+\Delta t}=I|X_i^t=V, \boldsymbol{X}^t\right) = \beta_2 \Delta t \sum_{j \in \mathcal{N}_i} 1_{\{X_j^t=I\}} + o\left(\Delta t\right) \\
            & \text{Pr}\left(X_i^{t+\Delta t}=V|X_i^t=S, \boldsymbol{X}^t\right) = \nu_i(L) \Delta t + o\left(\Delta t\right) \\
            & \text{Pr}\left(X_i^{t+\Delta t}=V|X_i^t=I, \boldsymbol{X}^t\right) = \delta \Delta t +o\left(\Delta t\right) \\
            & \text{Pr}\left(X_i^{t+\Delta t}=S|X_i^t=V, \boldsymbol{X}^t\right) = \omega \Delta t +o\left(\Delta t\right)
        \end{aligned}
\end{equation}

\noindent where \(\mathcal N_i\) denotes the neighborhood of node \(i\) and $1_{\{\mathcal X\}}$ is the indicator function.  The symbol \(o(\Delta t)\) collects higher-order infinitesimals satisfying $\lim\limits_{\Delta t \to 0} \frac{o(\Delta t)}{\Delta t} = 0$.  Infection rates satisfy \(\beta_{2} < \beta_{1}\) to reflect the partial protection afforded by vaccination, while \(\delta\) and \(\omega\) capture recovery with immunity and waning immunity, respectively. \(\nu_i(L) = v_{min} +  (v_{max} - v_{min})e^{-\alpha d_i(L)}\) models the vaccination rate for node \(i\) where \(v_{\max}\) and \(v_{\min}\) are the maximum and minimum achievable vaccination rate, \(\alpha>0\) is a decay parameter, and \(d_i(L)\) is the shortest-path distance from node \(i\) to the closest vaccination open facility among the set \(L\).

Model~\eqref{eq:StochasticModel} thus encodes the probability that node \(i\) changes compartment during \([t,t+\Delta t]\) given its current compartment and the infection status of its neighbors. Passing to the limit \(\Delta t \to 0\) yields a system of forward equations that forms the basis for both exact stochastic simulations and deterministic mean-field approximations in subsequent analyses.

\section{Mean-Field Approximation of the Stochastic Model}

We define the probabilities:
\begin{itemize}
    \item \( S_i(t) = \mathbb{E}[1_{\{X_i^t = S\}}] \): probability node \( i \) is susceptible at time \( t \),
    \item \( I_i(t) = \mathbb{E}[1_{\{X_i^t = I\}}] \): probability node \( i \) is infected at time \( t \),
    \item \( V_i(t) = \mathbb{E}[1_{\{X_i^t = V\}}] \): probability node \( i \) is vaccinated at time \( t \).
\end{itemize}

Assuming a mean-field approximation (independence between node states), we derive the following system of \acp{ODE} for each node \( i \):

\begin{equation} \label{eq:meanfield}
\boxed{
\begin{aligned}
\frac{dS_i}{dt} &= - \beta_1 S_i \sum_{j \in \mathcal{N}_i} I_j - \nu_i(d_i) S_i + \omega V_i \\
\frac{dI_i}{dt} &= \beta_1 S_i \sum_{j \in \mathcal{N}_i} I_j + \beta_2 V_i \sum_{j \in \mathcal{N}_i} I_j - \delta I_i \\
\frac{dV_i}{dt} &= \nu_i(d_i) S_i + \delta I_i - \beta_2 V_i \sum_{j \in \mathcal{N}_i} I_j - \omega V_i
\end{aligned}
}
\end{equation}

Here, \( \mathcal{N}_i \) denotes the neighborhood of node \( i \), and:
\begin{itemize}
    \item \( \beta_1 \): infection rate from susceptible to infected,
    \item \( \beta_2 \): infection rate from vaccinated to infected,
    \item \( \nu_i(L) \): vaccination rate for susceptible nodes,
    \item \( \delta \): transition rate from infected to vaccinated,
    \item \( \omega \): transition rate from vaccinated to susceptible.
\end{itemize}


\bibliography{refs}
% \printnomenclature



\end{document}

